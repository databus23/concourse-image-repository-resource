---
platform: linux

image_resource:
  type: docker-image
  source: { repository: concourse/docker-image-resource}

inputs:

- name: source 

run:
  path: sh
  args:
    - -ec
    - |
      source_repository=$(cat source/repository)
      tag=$(cat source/tag)
      source /opt/resource/common.sh
      start_docker
      log_in $USERNAME $PASSWORD
      echo docker pull $source_repository:$tag
      echo docker tag $source_repository:$tag $REPOSITORY:$tag
      echo docker push $REPOSITORY:$tag

params:
  USERNAME:
  PASSWORD:
  REPOSITORY:
